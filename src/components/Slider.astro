---
import Heading from "../components/Heading.astro";
---

<!-- Info slider-->
<div class="carousel w-full mx-auto max-w-6xl px-6">
  <!-- Slide 1 -->
  <div id="info1" class="carousel-item relative w-full">
    <div class="w-full rounded-xl border-2 border-primaryblue60 bg-beige p-10">
      <!-- Pile -->
      <div class="absolute right-6 top-6 flex gap-3">
        <a
          href="#info2"
          class="hover:bg-primaryblue60 hover:text-beige transition-colors duration-200
           w-10 h-10 flex items-center justify-center border-2 border-primaryblue60 rounded-full text-primaryblue60"
        >
          ←
        </a>
        <a
          href="#info2"
          class="hover:bg-primaryblue60 hover:text-beige transition-colors duration-200 w-10 h-10 flex items-center justify-center border-2 border-primaryblue60 rounded-full text-primaryblue60"
        >
          →
        </a>
      </div>

      <!-- Indhold -->
      <div class="justify-center text-center">
        <div class="mt-15 mb-6">
          <Heading htmlheading="h2" size="large"
            >“Jeg blev mere optimistisk på fremtiden og de næste skridt. Det
            gjorde en stor forskel at mærke, at jeg ikke stod alene, og at der
            faktisk findes et trygt sted, hvor man kan få støtte og blive
            forstået.”</Heading
          >
        </div>
        <div class="">
          <Heading htmlheading="h3" size="medium">- Anonym ung</Heading>
        </div>
      </div>
    </div>
  </div>

  <!-- Slide 2 -->
  <div id="info2" class="carousel-item relative w-full">
    <div class="w-full rounded-xl border-2 border-primaryblue60 bg-beige p-10">
      <!-- Pile -->
      <div class="absolute right-6 top-6 flex gap-3">
        <a
          href="#info1"
          class="hover:bg-primaryblue60 hover:text-beige transition-colors duration-200 w-10 h-10 flex items-center justify-center border-2 border-primaryblue60 rounded-full text-primaryblue60"
        >
          ←
        </a>
        <a
          href="#info1"
          class="hover:bg-primaryblue60 hover:text-beige transition-colors duration-200 w-10 h-10 flex items-center justify-center border-2 border-primaryblue60 rounded-full text-primaryblue60"
        >
          →
        </a>
      </div>

      <!-- Indhold -->
      <div class="justify-center text-center">
        <div class="mt-15 mb-6">
          <Heading htmlheading="h2" size="large"
            >“Efter forløbet føler jeg mig mere optimistisk omkring fremtiden og
            de næste skridt. Det gav mig mod på at arbejde videre med mig selv
            og en følelse af, at jeg godt kan komme igennem det, jeg står i.”</Heading
          >
        </div>
        <div class="">
          <Heading htmlheading="h3" size="medium">- Anonym ung</Heading>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Prikker -->
<div class="flex justify-center gap-4 mt-4">
  <a
    href="#info1"
    class="info-dot w-3 h-3 rounded-full bg-primaryblue60"
    aria-label="Gå til slide 1"></a>
  <a
    href="#info2"
    class="info-dot w-3 h-3 rounded-full border-2 border-primaryblue60 bg-transparent"
    aria-label="Gå til slide 2"></a>
</div>

<script>
  (function () {
    const slideEls = Array.from(document.querySelectorAll(".carousel-item"));
    if (!slideEls.length) return;

    const slideIds = slideEls.map((el) => "#" + el.id);

    const dots = Array.from(document.querySelectorAll(".info-dot"));

    if (dots.length !== slideIds.length) {
      console.warn("Antal dots matcher ikke antal slides:", {
        slides: slideIds.length,
        dots: dots.length,
      });
    }

    function setActiveIndex(activeIndex) {
      const idx = Math.max(0, Math.min(activeIndex, slideIds.length - 1));

      slideIds.forEach((id, i) => {
        const slide = document.querySelector(id);
        if (!slide) return;
        if (i === idx) {
          slide.classList.remove("hidden");
        } else {
          slide.classList.add("hidden");
        }
      });

      dots.forEach((dot, i) => {
        if (i === idx) {
          dot.classList.add("bg-primaryblue60");
          dot.classList.remove("border-2", "bg-transparent");
        } else {
          dot.classList.remove("bg-primaryblue60");
          dot.classList.add("border-2", "bg-transparent");
        }
      });
    }

    function getActiveIndexFromHash() {
      const hash = window.location.hash || "";
      const idx = slideIds.indexOf(hash);
      return idx !== -1 ? idx : 0;
    }

    setActiveIndex(getActiveIndexFromHash());

    window.addEventListener("hashchange", () => {
      setActiveIndex(getActiveIndexFromHash());
    });

    dots.forEach((dot, i) => {
      dot.addEventListener("click", (e) => {
        e.preventDefault();
        const targetHash =
          dot.getAttribute("href") || slideIds[i] || slideIds[0];
        history.replaceState(null, "", targetHash);
        setActiveIndex(i);
      });
    });

    const arrowAnchors = Array.from(
      document.querySelectorAll('.carousel a[href^="#"]')
    );
    arrowAnchors.forEach((a) => {
      a.addEventListener("click", (e) => {});
    });
  })();
</script>
